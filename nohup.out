  0%|          | 0/5 [00:00<?, ?it/s] 20%|██        | 1/5 [02:22<09:30, 142.52s/it] 40%|████      | 2/5 [02:28<03:06, 62.00s/it]  60%|██████    | 3/5 [02:33<01:12, 36.29s/it] 80%|████████  | 4/5 [02:39<00:24, 24.20s/it]100%|██████████| 5/5 [02:45<00:00, 17.47s/it]100%|██████████| 5/5 [02:45<00:00, 33.01s/it]
  0%|          | 0/5 [00:00<?, ?it/s] 20%|██        | 1/5 [02:26<09:45, 146.25s/it] 40%|████      | 2/5 [02:32<03:11, 63.70s/it]  60%|██████    | 3/5 [02:38<01:14, 37.36s/it] 80%|████████  | 4/5 [02:44<00:24, 24.94s/it]100%|██████████| 5/5 [02:50<00:00, 18.12s/it]100%|██████████| 5/5 [02:50<00:00, 34.02s/it]
Traceback (most recent call last):
  File "/home/mml/workspace/backdoor_detect/defense/our/defense_train.py", line 254, in <module>
    one_scene(dataset_name, model_name, attack_name, r_seed=r_seed)
  File "/home/mml/workspace/backdoor_detect/defense/our/defense_train.py", line 191, in one_scene
    poisoned_trainset, filtered_poisoned_testset, clean_trainset, clean_testset = get_all_dataset(dataset_name, model_name, attack_name, poisoned_ids)
  File "/home/mml/workspace/backdoor_detect/datasets/posisoned_dataset.py", line 335, in get_all_dataset
    return get_IAD_dataset(dataset_name, model_name, poisoned_ids)
  File "/home/mml/workspace/backdoor_detect/datasets/posisoned_dataset.py", line 101, in get_IAD_dataset
    filtered_ids = filter_dataset(clean_test_dataset,target_class)
  File "/home/mml/workspace/backdoor_detect/datasets/filter.py", line 11, in filter_dataset
    for _, batch in enumerate(clean_testset_loader):
  File "/home/mml/anaconda3/envs/backdoor_detect/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 630, in __next__
    data = self._next_data()
  File "/home/mml/anaconda3/envs/backdoor_detect/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1345, in _next_data
    return self._process_data(data)
  File "/home/mml/anaconda3/envs/backdoor_detect/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1371, in _process_data
    data.reraise()
  File "/home/mml/anaconda3/envs/backdoor_detect/lib/python3.9/site-packages/torch/_utils.py", line 694, in reraise
    raise exception
RuntimeError: Caught RuntimeError in pin memory thread for device 0.
Original Traceback (most recent call last):
  File "/home/mml/anaconda3/envs/backdoor_detect/lib/python3.9/site-packages/torch/utils/data/_utils/pin_memory.py", line 37, in do_one_step
    data = pin_memory(data, device)
  File "/home/mml/anaconda3/envs/backdoor_detect/lib/python3.9/site-packages/torch/utils/data/_utils/pin_memory.py", line 73, in pin_memory
    return type(data)([pin_memory(sample, device) for sample in data])  # type: ignore[call-arg]
  File "/home/mml/anaconda3/envs/backdoor_detect/lib/python3.9/site-packages/torch/utils/data/_utils/pin_memory.py", line 73, in <listcomp>
    return type(data)([pin_memory(sample, device) for sample in data])  # type: ignore[call-arg]
  File "/home/mml/anaconda3/envs/backdoor_detect/lib/python3.9/site-packages/torch/utils/data/_utils/pin_memory.py", line 58, in pin_memory
    return data.pin_memory(device)
RuntimeError: CUDA error: out of memory
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


terminate called without an active exception
  0%|          | 0/5 [00:00<?, ?it/s] 20%|██        | 1/5 [02:28<09:55, 148.83s/it] 40%|████      | 2/5 [02:34<03:13, 64.60s/it]  60%|██████    | 3/5 [02:40<01:15, 37.78s/it] 80%|████████  | 4/5 [02:46<00:25, 25.28s/it]100%|██████████| 5/5 [02:52<00:00, 18.38s/it]100%|██████████| 5/5 [02:52<00:00, 34.52s/it]
  0%|          | 0/5 [00:00<?, ?it/s] 20%|██        | 1/5 [02:24<09:36, 144.03s/it] 40%|████      | 2/5 [02:29<03:07, 62.54s/it]  60%|██████    | 3/5 [02:35<01:13, 36.69s/it] 80%|████████  | 4/5 [02:41<00:24, 24.45s/it]100%|██████████| 5/5 [02:46<00:00, 17.69s/it]100%|██████████| 5/5 [02:46<00:00, 33.37s/it]
  0%|          | 0/5 [00:00<?, ?it/s] 20%|██        | 1/5 [04:25<17:43, 265.79s/it] 40%|████      | 2/5 [04:34<05:43, 114.55s/it] 60%|██████    | 3/5 [04:43<02:12, 66.18s/it]  80%|████████  | 4/5 [04:51<00:43, 43.53s/it]100%|██████████| 5/5 [05:00<00:00, 30.96s/it]100%|██████████| 5/5 [05:00<00:00, 60.11s/it]
  0%|          | 0/5 [00:00<?, ?it/s] 20%|██        | 1/5 [04:19<17:16, 259.12s/it] 40%|████      | 2/5 [04:27<05:35, 111.78s/it] 60%|██████    | 3/5 [04:36<02:09, 64.66s/it]  80%|████████  | 4/5 [04:44<00:42, 42.49s/it]100%|██████████| 5/5 [04:53<00:00, 30.23s/it]100%|██████████| 5/5 [04:53<00:00, 58.67s/it]
  0%|          | 0/5 [00:00<?, ?it/s]